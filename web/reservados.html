<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MOVEYOU Rent - Vehículos Disponibles</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <header>
    <h1>MOVEYOU Rent</h1>
    <nav>
      <ul>
        <li><a href="index.html">Inicio</a></li>
        <li><a href="vehiculos.html">Vehículos</a></li>
        <li><a href="reservados.html" class="active">Reservas</a></li>
        <li><a href="disponibles.html">Disponibles</a></li>
        <li><a href="contacto.html">Contacto</a></li>
      </ul>
    </nav>
  </header>

  <section class="hero vehicle-hero">
    <h2>Vehiculos Reservados</h2>
    <p>Vehiculos en uso por clientes contentos</p>
  </section>

  <section class="filtros-container">
    <h3>Filtrar por:</h3>
    <div class="filtros">
      <div class="filtro-grupo">
        <label for="tipo">Tipo:</label>
        <select id="tipo" name="tipo">
          <option value="todos">Todos</option>
          <option value="turismo">Turismo</option>
          <option value="moto">Moto</option>
          <option value="furgoneta">Furgoneta</option>
        </select>
      </div>

      <button class="boton-filtrar">Aplicar filtros</button>
    </div>
  </section>

  <section class="vehiculos-container">

  </section>

  <footer>
    &copy; 2025 MOVEYOU Rent. Todos los derechos reservados.
  </footer>
</body>
</html>

<script>
  // Variable global donde se guardarán todos los vehículos del JSON
  let todosLosVehiculos = [];

  // Función para cargar los datos del archivo alquilados.json
  async function cargarVehiculos() {
    const respuesta = await fetch('alquilados.json'); // carga el archivo de vehículos alquilados
    const vehiculos = await respuesta.json(); // lo convierte a objeto JS
    todosLosVehiculos = vehiculos; // guardamos la lista completa para filtrarla más adelante
    mostrarVehiculos(vehiculos); // se muestran todos los vehículos al cargar
  }

  // Función para mostrar un listado de vehículos recibido como parámetro
  function mostrarVehiculos(lista) {
    const contenedor = document.querySelector('.vehiculos-container'); // nos posicionamos en el contenedor
    contenedor.innerHTML = ''; // limpiamos su contenido

    // para cada vehículo se crea una tarjeta o contenedor div
    lista.forEach(vehiculo => {
      const tarjeta = document.createElement('div');
      tarjeta.classList.add('vehiculo-card');

      // se guarda el subtipo de turismo o furgoneta para que no haya problemas
      const subtipo = vehiculo.tipoTurismo || vehiculo.tipoFurgo;
      const tipo = vehiculo.tipo.toLowerCase();

      // Solo mostrar etiqueta si es turismo o furgoneta
      const etiquetaHTML = (tipo === 'turismo' || tipo === 'furgoneta') && subtipo
        ? `<span class="etiqueta ${subtipo.toLowerCase()}">${subtipo.charAt(0).toUpperCase() + subtipo.slice(1)}</span>`
        : '';

      // rellena las tarjetas html con la información del vehículo.
      // se formatea el subtipo y la fecha
      tarjeta.innerHTML = `
        <div class="vehiculo-imagen">
          <img src="fotos/${vehiculo.modelo}.jpeg" alt="${vehiculo.marca} ${vehiculo.modelo}">
          ${etiquetaHTML}
        </div>
        <div class="vehiculo-info">
          <h3>${vehiculo.marca} ${vehiculo.modelo}</h3>
          <span class="tipo">${vehiculo.tipo}</span>
          <ul class="caracteristicas">
            <li><strong>Color:</strong> ${vehiculo.color}</li>
            <li><strong>Plazas:</strong> ${vehiculo.plazas}</li>
            <li><strong>Año:</strong> ${vehiculo.fechaMatriculacion.split('-')[0]}</li>
            <li><strong>Precio/hora:</strong> <span class="precio">${vehiculo.precioHora}€</span></li>
          </ul>
          <div class="cliente-info">
            <p><strong>Alquilado por:</strong>${vehiculo.nombre}</p>
            <p><strong>DNI:</strong> ${vehiculo.dni}</p>
            <p><strong>Email:</strong> ${vehiculo.email}</p>
          </div>
        </div>
      `;
      contenedor.appendChild(tarjeta); // añadimos la tarjeta al contenedor
    });
  }

  // Cuando se carga la página se ejecuta la función cargarVehiculos
  document.addEventListener('DOMContentLoaded', cargarVehiculos);

  // Cuando se pulsa el botón "Aplicar filtros" se filtra el tipo seleccionado
  document.querySelector('.boton-filtrar').addEventListener('click', () => {
    const tipoSeleccionado = document.getElementById('tipo').value; // obtenemos el tipo seleccionado

    let filtrados = todosLosVehiculos;

    // si se ha elegido un tipo distinto a todos se filtra la lista
    if (tipoSeleccionado !== 'todos') {
      filtrados = todosLosVehiculos.filter(vehiculo =>
        vehiculo.tipo.toLowerCase() === tipoSeleccionado.toLowerCase()
      );
    }

    mostrarVehiculos(filtrados); // mostramos los vehículos filtrados
  });
</script>

